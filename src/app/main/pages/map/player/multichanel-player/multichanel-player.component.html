<div *ngIf="state$ | async as multiState">
  <div class="player__container" *ngIf="multiState[0] && isVisible" [class.loading]="isPreloader">
    <div class="player__actions">
      <button class="btn__player back" (click)="backward(slider.value)">
        <svg width="22" height="15" viewBox="0 0 22 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M21.0037 12.5063C21.0044 12.705 20.9518 12.9003 20.8515 13.071C20.7512 13.2417 20.6071 13.3814 20.4345 13.4751C20.2648 13.5784 20.0708 13.633 19.873 13.633C19.6752 13.633 19.4811 13.5784 19.3115 13.4751L11.4969 8.31813C11.3444 8.21924 11.2189 8.08294 11.132 7.9218C11.0451 7.76065 10.9995 7.57986 10.9995 7.39611C10.9995 7.21236 11.0451 7.03157 11.132 6.87043C11.2189 6.70928 11.3444 6.57298 11.4969 6.4741L19.3115 1.28582C19.4811 1.18253 19.6752 1.12798 19.873 1.12798C20.0708 1.12798 20.2648 1.18253 20.4345 1.28582C20.6071 1.37954 20.7512 1.51926 20.8515 1.68997C20.9518 1.86068 21.0044 2.05592 21.0037 2.25471V12.5063Z"
            fill="#282828"
            stroke="#282828"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M11.0037 12.5063C11.0044 12.705 10.9518 12.9003 10.8515 13.071C10.7512 13.2417 10.6071 13.3814 10.4345 13.4751C10.2648 13.5784 10.0708 13.633 9.87299 13.633C9.67521 13.633 9.48115 13.5784 9.31151 13.4751L1.49686 8.31813C1.3444 8.21924 1.21892 8.08294 1.132 7.9218C1.04508 7.76065 0.999513 7.57986 0.999513 7.39611C0.999513 7.21236 1.04508 7.03157 1.132 6.87043C1.21892 6.70928 1.3444 6.57298 1.49686 6.4741L9.31151 1.28582C9.48115 1.18253 9.67521 1.12798 9.87299 1.12798C10.0708 1.12798 10.2648 1.18253 10.4345 1.28582C10.6025 1.37699 10.7437 1.51182 10.8437 1.67655C10.9437 1.84127 10.9989 2.02999 11.0037 2.22346V12.5063Z"
            fill="#282828"
            stroke="#282828"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
      <button class="btn__player prev" (click)="previous()">
        <svg width="15" height="19" viewBox="0 0 15 19" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1.01465 1.38086V17.9621" stroke="#282828" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          <path
            d="M13.9895 15.6151C13.9901 15.8446 13.9298 16.0699 13.8149 16.2675C13.7 16.465 13.5348 16.6274 13.3366 16.7375C13.1458 16.8495 12.9293 16.9084 12.7089 16.9084C12.4885 16.9084 12.272 16.8495 12.0811 16.7375L3.05369 10.7428C2.87748 10.6271 2.73259 10.4685 2.63227 10.2813C2.53194 10.0942 2.47938 9.88448 2.47938 9.67137C2.47938 9.45826 2.53194 9.24855 2.63227 9.0614C2.73259 8.87424 2.87748 8.7156 3.05369 8.59997L12.1062 2.65623C12.2971 2.54429 12.5136 2.48535 12.734 2.48535C12.9544 2.48535 13.1709 2.54429 13.3618 2.65623C13.5599 2.76637 13.7251 2.92876 13.84 3.1263C13.9549 3.32384 14.0153 3.54921 14.0146 3.77866L13.9895 15.6151Z"
            fill="#282828"
            stroke="#282828"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
      <button class="btn__player play" (click)="play()" [disabled]="multiState[0].error" *ngIf="!multiState[0].playing">
        <svg width="31" height="31" viewBox="0 0 31 31" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M15.5 0C6.944 0 0 6.7456 0 15.0571C0 23.3687 6.944 30.1143 15.5 30.1143C24.056 30.1143 31 23.3687 31 15.0571C31 6.7456 24.056 0 15.5 0ZM12.4 21.8329V8.28143L21.7 15.0571L12.4 21.8329Z"
            fill="#131313"
          />
        </svg>
      </button>
      <button class="btn__player pause" (click)="pause()" *ngIf="multiState[0].playing">
        <svg width="32" height="31" viewBox="0 0 32 31" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="15.5146" cy="15.5" r="15.5" fill="#282828" />
          <path
            d="M13.7096 10.2391H11.4889C10.9983 10.2391 10.6006 10.6431 10.6006 11.1415V21.0676C10.6006 21.566 10.9983 21.97 11.4889 21.97H13.7096C14.2001 21.97 14.5978 21.566 14.5978 21.0676V11.1415C14.5978 10.6431 14.2001 10.2391 13.7096 10.2391Z"
            fill="#FEFEFE"
          />
          <path
            d="M20.2994 10.2392H18.0787C17.5881 10.2392 17.1904 10.6432 17.1904 11.1415V21.0677C17.1904 21.5661 17.5881 21.9701 18.0787 21.9701H20.2994C20.79 21.9701 21.1877 21.5661 21.1877 21.0677V11.1415C21.1877 10.6432 20.79 10.2392 20.2994 10.2392Z"
            fill="#FEFEFE"
          />
        </svg>
      </button>
      <button class="btn__player next" (click)="next()">
        <svg width="15" height="19" viewBox="0 0 15 19" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.0146 1.38086V17.9621" stroke="#282828" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          <path
            d="M1.03976 15.6151C1.03915 15.8446 1.09947 16.0699 1.21437 16.2675C1.32928 16.465 1.49451 16.6274 1.69265 16.7375C1.88352 16.8495 2.10003 16.9084 2.32043 16.9084C2.54082 16.9084 2.75733 16.8495 2.9482 16.7375L11.9756 10.7428C12.1518 10.6271 12.2967 10.4685 12.397 10.2813C12.4974 10.0942 12.5499 9.88448 12.5499 9.67137C12.5499 9.45826 12.4974 9.24855 12.397 9.0614C12.2967 8.87424 12.1518 8.7156 11.9756 8.59997L2.92309 2.65623C2.73222 2.54429 2.51571 2.48535 2.29531 2.48535C2.07492 2.48535 1.85841 2.54429 1.66754 2.65623C1.4694 2.76637 1.30417 2.92876 1.18926 3.1263C1.07436 3.32384 1.01404 3.54921 1.01465 3.77866L1.03976 15.6151Z"
            fill="#282828"
            stroke="#282828"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
      <button class="btn__player forward" (click)="forward(slider.value)">
        <svg width="22" height="15" viewBox="0 0 22 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M1.30372 12.5062C1.30297 12.705 1.35557 12.9002 1.45585 13.071C1.55614 13.2417 1.70031 13.3814 1.8729 13.4751C2.04254 13.5784 2.2366 13.6329 2.43438 13.6329C2.63216 13.6329 2.82623 13.5784 2.99587 13.4751L10.8105 8.31808C10.963 8.2192 11.0885 8.08289 11.1754 7.92175C11.2623 7.76061 11.3079 7.57982 11.3079 7.39607C11.3079 7.21232 11.2623 7.03153 11.1754 6.87038C11.0885 6.70924 10.963 6.57294 10.8105 6.47405L2.99587 1.28577C2.82623 1.18249 2.63216 1.12793 2.43438 1.12793C2.2366 1.12793 2.04254 1.18249 1.8729 1.28577C1.70031 1.37949 1.55614 1.51921 1.45585 1.68992C1.35557 1.86063 1.30297 2.05587 1.30372 2.25467V12.5062Z"
            fill="#282828"
            stroke="#282828"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M11.3037 12.5062C11.303 12.705 11.3556 12.9002 11.4559 13.071C11.5561 13.2417 11.7003 13.3814 11.8729 13.4751C12.0425 13.5784 12.2366 13.6329 12.4344 13.6329C12.6322 13.6329 12.8262 13.5784 12.9959 13.4751L20.8105 8.31808C20.963 8.2192 21.0885 8.08289 21.1754 7.92175C21.2623 7.76061 21.3079 7.57982 21.3079 7.39607C21.3079 7.21232 21.2623 7.03153 21.1754 6.87038C21.0885 6.70924 20.963 6.57294 20.8105 6.47405L12.9959 1.28577C12.8262 1.18249 12.6322 1.12793 12.4344 1.12793C12.2366 1.12793 12.0425 1.18249 11.8729 1.28577C11.7049 1.37695 11.5636 1.51178 11.4636 1.6765C11.3637 1.84122 11.3085 2.02995 11.3037 2.22341V12.5062Z"
            fill="#282828"
            stroke="#282828"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
    </div>
    <div class="player__actions__mobile">
      <button class="btn__player__mobile backward" (click)="backward(slider.value)">
        <svg width="47" height="32" viewBox="0 0 47 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M44.9687 27.7415C44.9703 28.1969 44.8574 28.6441 44.642 29.0352C44.4266 29.4262 44.1169 29.7463 43.7462 29.961C43.3818 30.1976 42.965 30.3225 42.5401 30.3225C42.1153 30.3225 41.6985 30.1976 41.3341 29.961L24.5487 18.1478C24.2212 17.9213 23.9517 17.6091 23.765 17.2399C23.5783 16.8708 23.4804 16.4567 23.4804 16.0357C23.4804 15.6148 23.5783 15.2007 23.765 14.8316C23.9517 14.4624 24.2212 14.1502 24.5487 13.9237L41.3341 2.03894C41.6985 1.80234 42.1153 1.67737 42.5401 1.67737C42.965 1.67737 43.3818 1.80234 43.7462 2.03894C44.1169 2.25362 44.4266 2.57367 44.642 2.96472C44.8574 3.35576 44.9703 3.803 44.9687 4.25838V27.7415Z"
            fill="#282828"
            stroke="#282828"
            stroke-width="2.3871"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M23.4883 27.7415C23.4899 28.1969 23.3769 28.6441 23.1615 29.0352C22.9461 29.4262 22.6364 29.7463 22.2657 29.961C21.9013 30.1976 21.4845 30.3225 21.0597 30.3225C20.6349 30.3225 20.218 30.1976 19.8536 29.961L3.06822 18.1478C2.74075 17.9213 2.47123 17.6091 2.28452 17.2399C2.09782 16.8708 1.99995 16.4567 1.99995 16.0357C1.99995 15.6148 2.09782 15.2007 2.28452 14.8316C2.47123 14.4624 2.74075 14.1502 3.06822 13.9237L19.8536 2.03894C20.218 1.80234 20.6349 1.67737 21.0597 1.67737C21.4845 1.67737 21.9013 1.80234 22.2657 2.03894C22.6266 2.24779 22.93 2.55664 23.1447 2.93397C23.3595 3.31131 23.4781 3.74362 23.4883 4.18679V27.7415Z"
            fill="#282828"
            stroke="#282828"
            stroke-width="2.3871"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
      <button class="btn__player__mobile play" (click)="play()" [disabled]="multiState[0].error" *ngIf="!multiState[0].playing">
        <svg width="74" height="74" viewBox="0 0 74 74" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M37 0C16.576 0 0 16.576 0 37C0 57.424 16.576 74 37 74C57.424 74 74 57.424 74 37C74 16.576 57.424 0 37 0ZM29.6 53.65V20.35L51.8 37L29.6 53.65Z"
            fill="#131313"
          />
        </svg>
      </button>
      <button class="btn__player__mobile pause" (click)="pause()" *ngIf="multiState[0]?.playing">
        <svg width="74" height="74" viewBox="0 0 74 74" fill="none" xmlns="http://www.w3.org/2000/svg">
          <ellipse cx="36.9997" cy="37" rx="36.82" ry="37" fill="#282828" />
          <path
            d="M32.7775 23.871H28.1596C27.1395 23.871 26.3125 24.8354 26.3125 26.025V49.7198C26.3125 50.9094 27.1395 51.8738 28.1596 51.8738H32.7775C33.7976 51.8738 34.6246 50.9094 34.6246 49.7198V26.025C34.6246 24.8354 33.7976 23.871 32.7775 23.871Z"
            fill="#FEFEFE"
          />
          <path
            d="M46.4806 23.871H41.8628C40.8426 23.871 40.0156 24.8354 40.0156 26.025V49.7198C40.0156 50.9094 40.8426 51.8738 41.8628 51.8738H46.4806C47.5007 51.8738 48.3277 50.9094 48.3277 49.7198V26.025C48.3277 24.8354 47.5007 23.871 46.4806 23.871Z"
            fill="#FEFEFE"
          />
        </svg>
      </button>
      <button class="btn__player__mobile forward" (click)="forward(slider.value)">
        <svg width="47" height="32" viewBox="0 0 47 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M2.03127 27.7415C2.02967 28.1969 2.14264 28.6441 2.35804 29.0352C2.57344 29.4262 2.88313 29.7463 3.25383 29.961C3.61821 30.1976 4.03505 30.3225 4.45986 30.3225C4.88468 30.3225 5.30152 30.1976 5.6659 29.961L22.4513 18.1478C22.7788 17.9213 23.0483 17.6091 23.235 17.2399C23.4217 16.8708 23.5196 16.4567 23.5196 16.0357C23.5196 15.6148 23.4217 15.2007 23.235 14.8316C23.0483 14.4624 22.7788 14.1502 22.4513 13.9237L5.6659 2.03894C5.30152 1.80234 4.88468 1.67737 4.45986 1.67737C4.03505 1.67737 3.61821 1.80234 3.25383 2.03894C2.88313 2.25362 2.57344 2.57367 2.35804 2.96472C2.14264 3.35576 2.02967 3.803 2.03127 4.25838V27.7415Z"
            fill="#282828"
            stroke="#282828"
            stroke-width="2.3871"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M23.5117 27.7415C23.5101 28.1969 23.6231 28.6441 23.8385 29.0352C24.0539 29.4262 24.3636 29.7463 24.7343 29.961C25.0987 30.1976 25.5155 30.3225 25.9403 30.3225C26.3651 30.3225 26.782 30.1976 27.1464 29.961L43.9318 18.1478C44.2592 17.9213 44.5288 17.6091 44.7155 17.2399C44.9022 16.8708 45 16.4567 45 16.0357C45 15.6148 44.9022 15.2007 44.7155 14.8316C44.5288 14.4624 44.2592 14.1502 43.9318 13.9237L27.1464 2.03894C26.782 1.80234 26.3651 1.67737 25.9403 1.67737C25.5155 1.67737 25.0987 1.80234 24.7343 2.03894C24.3734 2.24779 24.07 2.55664 23.8553 2.93397C23.6405 3.31131 23.5219 3.74362 23.5117 4.18679V27.7415Z"
            fill="#282828"
            stroke="#282828"
            stroke-width="2.3871"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
    </div>
    <div class="player__timeline">
      <input
        #slider
        class=""
        type="range"
        min="0"
        step="0.1"
        [max]="multiState[0].duration"
        [value]="multiState[0].currentTime || 0"
        (input)="onSliderChangeEnd($event)"
        [disabled]="multiState[0].error && multiState[0].currentTime === undefined"
      />
      <span class="timeline__time current__time">{{ multiState[0].readableCurrentTime }}</span>
      <span class="timeline__time duration">{{ multiState[0].readableDuration }}</span>
    </div>
  </div>

  <div class="player__multichanel__items" *ngIf="isVisible">
    <div class="multichanel__item" *ngFor="let state of multiState; let i = index">
      <div class="item__aside">
        <div class="item__name">Chanel {{ i + 1 }}</div>
        <div class="item__actions">
          <button mat-icon-button (click)="muteToggle(i)" [color]="state.muted ? 'warn' : ''" aria-label="mute unmute button">
            <mat-icon *ngIf="!state.muted">volume_up</mat-icon>
            <mat-icon *ngIf="state.muted">volume_off</mat-icon>
          </button>
        </div>
      </div>

      <div class="item__timeline">
        <input
          class=""
          type="range"
          min="0"
          step="0.1"
          [max]="state.duration"
          [value]="state.currentTime || 0"
          [disabled]="state.error && state.currentTime === undefined"
        />
        <span class="timeline__time current__time">{{ state.readableCurrentTime }}</span>
        <span class="timeline__time duration">{{ state.readableDuration }}</span>
      </div>
    </div>
  </div>
</div>
